# todo: simplify based on paper